<VirtualHost *:80>
    ServerName your-domain.com

    DocumentRoot "/usr/local/www/drawfun"

    # React前端应用
    <Directory "/usr/local/www/drawfun">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        RewriteEngine On
        RewriteBase /
        RewriteRule ^index\.html$ - [L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule . /index.html [L]
    </Directory>

    # 后端API接口 - 使用PHP-FPM（备选配置）
    Alias /api "/usr/local/www/drawfun/api"
    <Directory "/usr/local/www/drawfun/api">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted

        # 使用mod_proxy_fcgi
        <FilesMatch \.php$>
            SetHandler "proxy:fcgi://127.0.0.1:9000"
            # 或者如果使用Unix socket:
            # SetHandler "proxy:unix:/var/run/php-fpm.sock|fcgi://localhost/"
        </FilesMatch>
    </Directory>

    # phpMyAdmin - 使用PHP-FPM（备选配置）
    Alias /pa "/usr/local/www/phpMyAdmin"
    <Directory "/usr/local/www/phpMyAdmin">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted

        <FilesMatch \.php$>
            SetHandler "proxy:fcgi://127.0.0.1:9000"
            # 或者如果使用Unix socket:
            # SetHandler "proxy:unix:/var/run/php-fpm.sock|fcgi://localhost/"
        </FilesMatch>
    </Directory>

    # 静态资源缓存
    <IfModule mod_expires.c>
        ExpiresActive On
        # ... 缓存配置同上
    </IfModule>
</VirtualHost>
